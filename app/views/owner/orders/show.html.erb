<div class="container">

    <h3 class="order-title-show">
    <strong>注文詳細画面</strong>
    </h3>

    <table class="table table-striped">
        <tr>
            <th>購入者</th>
            <td>
                <%= link_to (@order.members.first_name << @order.members.last_name), owner_member_path(@order.member.id) %>
            </td>
        </tr>
        <tr>
            <th>配送先</th>
            <td>
                <p>〒<%= @order.postalcode %><%= @order.address %><br>
                    <%= @order.name %></p>
            </td>
        </tr>
        <tr>
            <th>支払い方法</th>
            <td><%= @order.pay %></td>
        </tr>
        <tr>
            <th>注文ステータス変更</th>
            <td>
                <%= form_with(model: @order, local: true, url: owner_order_path(@order), method: :patch) do |f| %>
                    <%= f.select :status, Order.statuses.keys, {include_blank: true} %>
                    <%= f.submit '変更' %>
                <% end %>
            </td>
        </tr>
    </table>

    <table class="table table-bordered">
        <tr class="active">
            <th>商品名</th>
            <th>金額(税込)</th>
            <th>数量</th>
            <th>小計</th>
            <th>製作ステータス</th>
        </tr>

        <% @order.ordered_products.each do |ordered_product| %>
            <tr>
                <td><%= ordered_product.name %></td>
                <td><%= ordered_product.price %></td>
                <td><%= ordered_product.count %></td>
                <td><%= ordered_product.count * ordered_product.price %></td>
                <td>
                    <%= form_with(model: ordered_product, local: true, url: owner_path, method: :patch) do |f| %>
                        <%= f.select :production_status, OrderedProduct.production_statuses.keys, {include_blank: true} %>
                        <%= f.submit '変更' %>
                    <% end %>
                </td>
            </tr>
        <% end %>
    </table>

    <table class= "order-amount-table">
        <tr>
            <th>商品合計</th>
            <td><%= @ordered.price %>円</td>
        </tr>
        <tr>
            <th>送料</th>
            <td><%= @order.postage %>円</td>
        </tr>
        <tr>
            <th>請求金額合計</th>
            <td><%= @ordered.price + @order.postage %>円</td>
        </tr>
    </table>
</div>